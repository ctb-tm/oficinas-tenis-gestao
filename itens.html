<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro - Itens - Oficinas de Tênis</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 95%; /* 95% para dar espaço à tabela larga */
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Estilos do Menu de Navegação */
        .nav-menu {
            overflow: hidden;
            border-bottom: 2px solid #0066cc;
            margin-bottom: 20px;
        }
        .nav-link {
            background-color: #f1f1f1;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            font-size: 17px;
            border-radius: 5px 5px 0 0;
            transition: background-color 0.3s;
            color: #333;
            text-decoration: none;
        }
        .nav-link:hover {
            background-color: #ddd;
        }
        .nav-link.active {
            background-color: #0066cc;
            color: white;
        }

        /* Estilos da Tabela Mensal */
        .monthly-table-wrapper {
            overflow-x: auto; /* Permite rolagem horizontal */
        }
        .monthly-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        .monthly-table th, .monthly-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            min-width: 150px; /* Largura mínima para colunas de mês */
        }
        .monthly-table th {
            background-color: #0066cc;
            color: white;
            white-space: nowrap;
        }
        .monthly-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* Colunas "Grudadas" (Sticky) */
        .monthly-table td:first-child,
        .monthly-table td:nth-child(2),
        .monthly-table th:first-child,
        .monthly-table th:nth-child(2) {
            position: sticky;
            left: 0;
            background-color: #f9f9f9; /* Fundo para destacar */
            z-index: 1;
        }
        .monthly-table td:first-child,
        .monthly-table th:first-child {
            left: 0;
            min-width: 250px;
            text-align: left;
            font-weight: bold;
        }
        .monthly-table th:nth-child(2),
        .monthly-table td:nth-child(2) {
            left: 250px; /* Largura da primeira coluna */
            min-width: 160px;
        }
        
        /* Célula de Mês */
        .orcado-mes span {
            font-size: 0.9em;
            color: #555;
            display: block;
            margin-bottom: 5px;
        }
        input[type='number'] {
            width: 110px;
            text-align: right;
            padding: 5px;
            box-sizing: border-box; 
        }

        /* Barra de Gráfico */
        .grafico-barra {
            height: 20px;
            background-color: #28a745;
            text-align: right;
            color: white;
            padding-right: 5px;
            border-radius: 5px;
            width: 0%; 
            min-width: 25px; 
            box-sizing: border-box;
            transition: width 0.3s ease-in-out;
            font-size: 0.9em;
            line-height: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Controle Financeiro - Oficinas Educacionais de Tênis</h1>
        
        <div class="nav-menu">
            <a href="financeiro.html" class="nav-link">Resumo Orçamentário</a>
            <a href="itens.html" class="nav-link active">Controle Mensal por Item</a>
        </div>

        <div>
            <h2>Controle Mensal por Item (Novembro/2025 - Outubro/2026)</h2>
            <div class="monthly-table-wrapper">
                <table class="monthly-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Total Orçado</th>
                            <th>Nov/2025 (Mês 1)</th>
                            <th>Dez/2025 (Mês 2)</th>
                            <th>Jan/2026 (Mês 3)</th>
                            <th>Fev/2026 (Mês 4)</th>
                            <th>Mar/2026 (Mês 5)</th>
                            <th>Abr/2026 (Mês 6)</th>
                            <th>Mai/2026 (Mês 7)</th>
                            <th>Jun/2026 (Mês 8)</th>
                            <th>Jul/2026 (Mês 9)</th>
                            <th>Ago/2026 (Mês 10)</th>
                            <th>Set/2026 (Mês 11)</th>
                            <th>Out/2026 (Mês 12)</th>
                            <th>Total Executado</th>
                            <th>Saldo</th>
                            <th>% Executado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="367075.00">Material de Consumo / Esportivo</td>
                            <td>R$ 367.075,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 367.075,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>
                        
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="121494.60">Uniformes</td>
                            <td>R$ 121.494,60</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 121.494,60</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="8052.96">Material Permanente / Equipamento</td>
                            <td>R$ 8.052,96</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 8.052,96</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="158400.00">Recursos Humanos</td>
                            <td>R$ 158.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="107712.00">Encargos Trabalhistas</td>
                            <td>R$ 107.712,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 41.712,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>
                        
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="26100.00">Hospedagem / Alimentação</td>
                            <td>R$ 26.100,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="100000.00">Transporte / Locomoção</td>
                            <td>R$ 100.000,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="143600.04">Locação de Espaços</td>
                            <td>R$ 143.600,04</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="128000.00">Serviços Operacionais</td>
                            <td>R$ 128.000,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="146400.00">Serviços de Terceiros</td>
                            <td>R$ 146.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="20400.00">Divulgação / Promoção</td>
                            <td>R$ 20.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 20.400,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        
        /**
         * Formata um número para o padrão de moeda BRL (R$).
         */
        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        /**
         * Atualiza os totais de uma linha na tabela MENSAL POR ITEM.
         * @param {HTMLElement} inputElement O input de mês que foi alterado.
         */
        function atualizarTotaisItem(inputElement) {
            const linha = inputElement.closest('tr.item-row');
            if (!linha) return;

            const totalOrcadoElement = linha.querySelector('.total-orcado');
            const totalOrcado = parseFloat(totalOrcadoElement.dataset.valorTotal) || 0;
            
            let totalExecutado = 0;
            const inputsMensais = linha.querySelectorAll('.executado-mes');
            inputsMensais.forEach(input => {
                totalExecutado += parseFloat(input.value) || 0;
            });
            
            const saldo = totalOrcado - totalExecutado;
            const percentual = (totalOrcado > 0) ? (totalExecutado / totalOrcado) * 100 : 0;
            
            linha.querySelector('.total-executado-item').textContent = formatCurrency(totalExecutado);
            linha.querySelector('.saldo-item').textContent = formatCurrency(saldo);
            
            const barra = linha.querySelector('.grafico-barra');
            barra.style.width = percentual.toFixed(1) + '%';
            barra.textContent = percentual.toFixed(1) + '%';
        }

        /**
         * Função principal que inicializa todos os cálculos da página.
         */
        function inicializarPagina() {
            const linhasItens = document.querySelectorAll('#itens tbody tr.item-row, .monthly-table tbody tr.item-row');
            linhasItens.forEach(linha => {
                const primeiroInput = linha.querySelector('.executado-mes');
                if (primeiroInput) {
                    atualizarTotaisItem(primeiroInput);
                }
            });
        }

        // Chama a função de inicialização quando a página terminar de carregar
        document.addEventListener('DOMContentLoaded', inicializarPagina);
    </script>

</body>
</html>
