<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro - Oficinas Educacionais de Tênis</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 95%; /* Aumentei para acomodar a tabela larga */
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Estilos da Tabela Padrão (Resumo) */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #0066cc;
            color: white;
            white-space: nowrap; /* Evita quebra de linha nos cabeçalhos */
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        input[type='number'] {
            width: 110px;
            text-align: right;
            padding: 5px;
            box-sizing: border-box; 
        }
        .grafico-barra {
            height: 20px;
            background-color: #28a745;
            text-align: right;
            color: white;
            padding-right: 5px;
            border-radius: 5px;
            width: 0%; 
            min-width: 25px; 
            box-sizing: border-box;
            transition: width 0.3s ease-in-out;
            font-size: 0.9em;
            line-height: 20px; /* Alinha o texto verticalmente */
        }

        /* Estilos das Abas */
        .tabs {
            overflow: hidden;
            border-bottom: 2px solid #0066cc;
            margin-bottom: 20px;
        }
        .tab-link {
            background-color: #f1f1f1;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            font-size: 17px;
            border-radius: 5px 5px 0 0;
            transition: background-color 0.3s;
        }
        .tab-link:hover {
            background-color: #ddd;
        }
        .tab-link.active {
            background-color: #0066cc;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 10px 0;
        }

        /* Estilos da Tabela Mensal */
        .monthly-table-wrapper {
            overflow-x: auto; /* Permite rolagem horizontal */
        }
        .monthly-table th, .monthly-table td {
            min-width: 150px; /* Largura mínima para colunas de mês */
        }
        .monthly-table td:first-child, /* Célula do Item */
        .monthly-table td:nth-child(2), /* Célula Total Orçado */
        .monthly-table th:first-child,
        .monthly-table th:nth-child(2) {
            position: sticky; /* "Gruda" as primeiras colunas à esquerda */
            left: 0;
            background-color: #f9f9f9; /* Fundo para destacar */
            z-index: 1;
        }
        .monthly-table td:first-child,
        .monthly-table th:first-child {
            left: 0;
            min-width: 250px; /* Mais espaço para o nome do item */
            text-align: left;
        }
        .monthly-table th:nth-child(2),
        .monthly-table td:nth-child(2) {
            left: 250px; /* Posição da segunda coluna "grudada" */
        }

        .orcado-mes span {
            font-size: 0.9em;
            color: #555;
            display: block;
            margin-bottom: 5px;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>Controle Financeiro - Oficinas Educacionais de Tênis</h1>
        
        <div class="tabs">
            <button class="tab-link active" onclick="openTab(event, 'resumo')">Resumo Orçamentário</button>
            <button class="tab-link" onclick="openTab(event, 'itens')">Controle Mensal por Item</button>
        </div>

        <div id="resumo" class="tab-content" style="display:block;">
            <h2>Resumo Orçamentário (Total)</h2>
            <table>
                <thead>
                    <tr>
                        <th style="text-align: left;">Ação</th>
                        <th>Valor Orçado (R$)</th>
                        <th>Executado (R$)</th>
                        <th>Saldo (R$)</th>
                        <th>% Executado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">Material de Consumo / Esportivo</td>
                        <td class="orcado" data-valor="367075.00">R$ 367.075,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Uniformes</td>
                        <td class="orcado" data-valor="121494.60">R$ 121.494,60</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Material Permanente / Equipamento</td>
                        <td class="orcado" data-valor="8052.96">R$ 8.052,96</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Recursos Humanos</td>
                        <td class="orcado" data-valor="158400.00">R$ 158.400,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Encargos Trabalhistas</td>
                        <td class="orcado" data-valor="107712.00">R$ 107.712,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Hospedagem / Alimentação</td>
                        <td class="orcado" data-valor="26100.00">R$ 26.100,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Transporte / Locomoção</td>
                        <td class="orcado" data-valor="100000.00">R$ 100.000,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Locação de Espaços</td>
                        <td class="orcado" data-valor="143600.04">R$ 143.600,04</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Serviços Operacionais</td>
                        <td class="orcado" data-valor="128000.00">R$ 128.000,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Serviços de Terceiros</td>
                        <td class="orcado" data-valor="146400.00">R$ 146.400,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Divulgação / Promoção</td>
                        <td class="orcado" data-valor="20400.00">R$ 20.400,00</td>
                        <td><input type="number" class="executado" value="0" oninput="atualizarExecucaoResumo()"></td>
                        <td class="saldo"></td>
                        <td><div class="grafico-barra"></div></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="itens" class="tab-content">
            <h2>Controle Mensal por Item (Novembro/2025 - Outubro/2026)</h2>
            <div class="monthly-table-wrapper">
                <table class="monthly-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Total Orçado</th>
                            <th>Nov/2025 (Mês 1)</th>
                            <th>Dez/2025 (Mês 2)</th>
                            <th>Jan/2026 (Mês 3)</th>
                            <th>Fev/2026 (Mês 4)</th>
                            <th>Mar/2026 (Mês 5)</th>
                            <th>Abr/2026 (Mês 6)</th>
                            <th>Mai/2026 (Mês 7)</th>
                            <th>Jun/2026 (Mês 8)</th>
                            <th>Jul/2026 (Mês 9)</th>
                            <th>Ago/2026 (Mês 10)</th>
                            <th>Set/2026 (Mês 11)</th>
                            <th>Out/2026 (Mês 12)</th>
                            <th>Total Executado</th>
                            <th>Saldo</th>
                            <th>% Executado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="367075.00">Material de Consumo / Esportivo</td>
                            <td>R$ 367.075,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 367.075,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>
                        
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="121494.60">Uniformes</td>
                            <td>R$ 121.494,60</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 121.494,60</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="8052.96">Material Permanente / Equipamento</td>
                            <td>R$ 8.052,96</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 8.052,96</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="158400.00">Recursos Humanos</td>
                            <td>R$ 158.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 13.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="107712.00">Encargos Trabalhistas</td>
                            <td>R$ 107.712,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 41.712,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 6.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>
                        
                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="26100.00">Hospedagem / Alimentação</td>
                            <td>R$ 26.100,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 2.610,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="100000.00">Transporte / Locomoção</td>
                            <td>R$ 100.000,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 10.000,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="143600.04">Locação de Espaços</td>
                            <td>R$ 143.600,04</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 11.966,67</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="128000.00">Serviços Operacionais</td>
                            <td>R$ 128.000,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.800,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="146400.00">Serviços de Terceiros</td>
                            <td>R$ 146.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 12.200,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                        <tr class="item-row">
                            <td class="total-orcado" data-valor-total="20400.00">Divulgação / Promoção</td>
                            <td>R$ 20.400,00</td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 20.400,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><div class="orcado-mes"><span>Orçado: R$ 0,00</span><input type="number" class="executado-mes" value="0" oninput="atualizarTotaisItem(this)"></div></td>
                            <td><strong class="total-executado-item"></strong></td>
                            <td><strong class="saldo-item"></strong></td>
                            <td style="min-width: 120px;"><div class="grafico-barra"></div></td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        
        /**
         * Formata um número para o padrão de moeda BRL (R$).
         * @param {number} value O número a ser formatado.
         * @returns {string} O valor formatado como R$ 1.234,56.
         */
        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        /**
         * Controla a exibição das abas.
         */
        function openTab(evt, tabName) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-link");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        /**
         * Atualiza os cálculos da tabela de RESUMO.
         */
        function atualizarExecucaoResumo() {
            const linhas = document.querySelectorAll('#resumo tbody tr');
            linhas.forEach(linha => {
                const orcado = parseFloat(linha.querySelector('.orcado').dataset.valor);
                const executadoInput = linha.querySelector('.executado');
                const executado = parseFloat(executadoInput.value) || 0;
                const saldo = orcado - executado;
                
                linha.querySelector('.saldo').textContent = formatCurrency(saldo);
                
                const percentual = (orcado > 0) ? (executado / orcado) * 100 : 0;
                
                const barra = linha.querySelector('.grafico-barra');
                barra.style.width = percentual.toFixed(1) + '%';
                barra.textContent = percentual.toFixed(1) + '%';
            });
        }

        /**
         * Atualiza os totais de uma linha na tabela MENSAL POR ITEM.
         * @param {HTMLElement} inputElement O input de mês que foi alterado.
         */
        function atualizarTotaisItem(inputElement) {
            // Encontra a linha (tr) pai do input que foi mexido
            const linha = inputElement.closest('tr');
            
            // Pega o valor total orçado da linha
            const totalOrcadoElement = linha.querySelector('.total-orcado');
            const totalOrcado = parseFloat(totalOrcadoElement.dataset.valorTotal) || 0;
            
            // Soma todos os inputs de "executado-mes" desta linha
            let totalExecutado = 0;
            const inputsMensais = linha.querySelectorAll('.executado-mes');
            inputsMensais.forEach(input => {
                totalExecutado += parseFloat(input.value) || 0;
            });
            
            // Calcula saldo e percentual
            const saldo = totalOrcado - totalExecutado;
            const percentual = (totalOrcado > 0) ? (totalExecutado / totalOrcado) * 100 : 0;
            
            // Atualiza os campos de total da linha
            linha.querySelector('.total-executado-item').textContent = formatCurrency(totalExecutado);
            linha.querySelector('.saldo-item').textContent = formatCurrency(saldo);
            
            const barra = linha.querySelector('.grafico-barra');
            barra.style.width = percentual.toFixed(1) + '%';
            barra.textContent = percentual.toFixed(1) + '%';
        }

        /**
         * Função principal que inicializa todos os cálculos da página.
         */
        function inicializarPagina() {
            // Calcula a tabela de Resumo
            atualizarExecucaoResumo();
            
            // Calcula todas as linhas da tabela de Itens Mensais
            const linhasItens = document.querySelectorAll('#itens tbody tr.item-row');
            linhasItens.forEach(linha => {
                // Pega o primeiro input da linha apenas como referência para a função
                const primeiroInput = linha.querySelector('.executado-mes');
                if (primeiroInput) {
                    atualizarTotaisItem(primeiroInput);
                }
            });
        }

        // Chama a função de inicialização quando a página terminar de carregar
        document.addEventListener('DOMContentLoaded', inicializarPagina);
    </script>

</body>
</html>
